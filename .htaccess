# CORRECTION : .htaccess sécurisé pour protéger les fichiers sensibles

# URL Rewriting pour le routeur
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# CORRECTION : Protection du fichier .env
<Files ".env">
    Require all denied
</Files>

# CORRECTION : Protection de la base SQLite
<Files "*.sqlite">
    Require all denied
</Files>

# CORRECTION : Cacher les signatures serveur
ServerSignature Off
Header unset X-Powered-By

# CORRECTION : Protection contre le clickjacking
Header always set X-Frame-Options "SAMEORIGIN"

# CORRECTION : Content Security Policy
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' fonts.googleapis.com; font-src fonts.gstatic.com"

# Headers de sécurité supplémentaires
Header set X-Content-Type-Options "nosniff"
Header set X-XSS-Protection "1; mode=block"

# Désactiver l'affichage des erreurs PHP en production
php_flag display_errors Off
php_flag display_startup_errors Off

# Empêcher l'affichage du contenu des répertoires
Options -Indexes

# Bloquer l'accès aux fichiers de sauvegarde et sensibles
<FilesMatch "\.(bak|backup|old|orig|save|swp|config|ini|log)$">
    Require all denied
</FilesMatch>

